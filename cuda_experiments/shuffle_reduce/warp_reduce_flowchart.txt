warp_reduce_sum 计算流程图 (32线程归约求和)

初始状态: 每个线程有自己的值(1-32)

步骤1: 与相隔16的线程交换并累加 (1+17, 2+18, ..., 16+32)
线程1 → 线程17
线程2 → 线程18
...
线程16 → 线程32

步骤2: 与相隔8的线程交换并累加 (1+9+17+25, 2+10+18+26, ..., 8+16+24+32)
线程1 → 线程9 → 线程17 → 线程25
线程2 → 线程10 → 线程18 → 线程26
...
线程8 → 线程16 → 线程24 → 线程32

步骤3: 与相隔4的线程交换并累加 (1+5+9+13+17+21+25+29, ..., 4+8+12+16+20+24+28+32)
线程1 → 线程5 → 线程9 → 线程13 → 线程17 → 线程21 → 线程25 → 线程29
...
线程4 → 线程8 → 线程12 → 线程16 → 线程20 → 线程24 → 线程28 → 线程32

步骤4: 与相隔2的线程交换并累加 (1+3+5+7+...+31, 2+4+6+8+...+32)
线程1 → 线程3 → 线程5 → ... → 线程31
线程2 → 线程4 → 线程6 → ... → 线程32

步骤5: 与相隔1的线程交换并累加 (1+2+3+...+32)
线程1 → 线程2 → 线程3 → ... → 线程32

最终结果: 所有线程得到总和528 (1+2+...+32)